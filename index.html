<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Base64 & Decimal Converter</title>
<style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    textarea, input { width: 100%; padding: 8px; margin-top: 5px; }
    button { padding: 8px 12px; margin-top: 10px; cursor: pointer; }
    .section { margin-bottom: 20px; padding: 10px; border: 1px solid #ccc; border-radius: 5px; }
    label { font-weight: bold; }
</style>
</head>
<body>

<h2>Base64 & Decimal Converter</h2>

<div class="section">
    <label>Base64 to Bytes (Hex):</label>
    <textarea id="base64Input" placeholder="Masukkan Base64 di sini"></textarea>
    <button onclick="base64ToBytes()">Convert</button>
    <textarea id="bytesOutput" readonly placeholder="Hasil Bytes (0x...)"></textarea>
</div>

<div class="section">
    <label>Bytes (Hex) to Base64:</label>
    <textarea id="hexInput" placeholder="Masukkan Hex (dengan atau tanpa 0x)"></textarea>
    <button onclick="bytesToBase64()">Convert</button>
    <textarea id="base64Output" readonly placeholder="Hasil Base64"></textarea>
</div>

<div class="section">
    <label>Decimal Array to Bytes32:</label>
    <textarea id="decimalInput" placeholder="[0,0,0,0,...]"></textarea>
    <button onclick="decimalToBytes32()">Convert</button>
    <textarea id="bytes32Output" readonly placeholder="Hasil Bytes32 (0x...)"></textarea>
</div>

<div class="section">
    <label>Bytes32 to Decimal Array:</label>
    <textarea id="bytes32Input" placeholder="0x..."></textarea>
    <button onclick="bytes32ToDecimal()">Convert</button>
    <textarea id="decimalOutput" readonly placeholder="[0,0,0,...]"></textarea>
</div>

<script>
function base64ToBytes() {
    let input = document.getElementById("base64Input").value.trim();
    if (!input) {
        alert("Base64 tidak boleh kosong!");
        return;
    }
    try {
        let buf = Buffer.from(input, 'base64');
        document.getElementById("bytesOutput").value = '0x' + buf.toString('hex');
    } catch (e) {
        alert("Base64 tidak valid!");
    }
}

function bytesToBase64() {
    let hex = document.getElementById("hexInput").value.trim().replace(/^0x/, '');
    if (!hex || hex.length % 2 !== 0 || !/^[0-9a-fA-F]+$/.test(hex)) {
        alert("Hex tidak valid!");
        return;
    }
    let buf = Buffer.from(hex, 'hex');
    document.getElementById("base64Output").value = buf.toString('base64');
}

function decimalToBytes32() {
    let input = document.getElementById("decimalInput").value.trim();
    input = input.replace(/^\[|\]$/g, ''); // hapus [ ]
    let decimals = input.split(',')
                        .map(x => parseInt(x.trim()))
                        .filter(x => !isNaN(x));
    if (decimals.length === 0) {
        alert("Decimal array tidak valid!");
        return;
    }
    let buf = Buffer.from(decimals);
    let hex = '0x' + buf.toString('hex').padStart(64, '0');
    document.getElementById("bytes32Output").value = hex;
}

function bytes32ToDecimal() {
    let hex = document.getElementById("bytes32Input").value.trim().replace(/^0x/, '');
    if (!hex || hex.length % 2 !== 0 || !/^[0-9a-fA-F]+$/.test(hex)) {
        alert("Bytes32 tidak valid!");
        return;
    }
    let buf = Buffer.from(hex, 'hex');
    let arr = Array.from(buf.values());
    document.getElementById("decimalOutput").value = `[${arr.join(',')}]`;
}
</script>

<!-- Tambah library Buffer agar jalan di browser -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/buffer/6.0.3/buffer.min.js"></script>
<script>
    window.Buffer = buffer.Buffer;
</script>

</body>
</html>
